<!doctype html>
<html lang="en">
<link rel="icon" type="image/png" href="/people/plewis/cpp/assets/img/favicon.png" >
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="search-domain" value="/people/plewis/cpp/">
    <link rel="stylesheet" type="text/css" href="/people/plewis/cpp/assets/css/main.css" />
    <title>Strom Phylogenetics C++ Tutorial: Adding the Model class</title>
  </head>
  <body>
    <div class="container">
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container-fluid">
      <a class="navbar-brand" href="/people/plewis/cpp/index.html">
        <img class="navbar-logo" src="/people/plewis/cpp/assets/img/strom-logo.png" alt="Strom Tutorial Home" />
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target=".navbar-collapse" aria-controls="#navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav mr-auto">   <!-- navbar-nav mr-auto -->
          <li class="nav-item"> 
            <a href="/people/plewis/cpp/">Home</a>
          </li>
          
          <li class="nav-item">
            <a href="/people/plewis/cpp/mac/steps/">Step-by-step instructions</a>
          </li>
          
          
        </ul>
      </div>
  </div>
</nav>

      <div class="titlebar">
	<h1 class="maintitle">11.0 Adding the Model class</h1>
	<h3 class="subtitle"></h3>
    <h3 class="subtitle">(Mac version)</h3>
</div>

<div class="titlebar">
	<h3 class="subsection"><a href="/people/plewis/cpp//mac//steps/step-10/00-calculating-the-likelihood.html">&lt;&nbsp;10.0</a> | 11.0 | <a href="/people/plewis/cpp//mac//steps/step-11/01-specifying-the-model.html">11.1&nbsp;&gt;</a></h3>
</div>

<p>In this part we add a Model class to handle the tedium associated with informing BeagleLib of the details of the substitution model. The Eigen library is used to manage calculation of transition probability matrices.</p>

<p>The only substitution model weâ€™ve implemented thus far has been the JC69 model. The only parameters of this model are edge lengths, and thus it does not model even the most basic aspects of molecular evolution, such as transition/transversion bias and unequal base frequencies. Furthermore, the JC69 model we used assumed that substitution rates were equal across sites and thus did not accommodate among-site rate heterogeneity. This section introduces the standard GTR+I+G model, which can handle among-site rate heterogeneity, unequal nucleotide frequencies, and unequal exchangeabilities (including transition/transversion bias) as well as a codon model that takes into account unequal codon frequencies and the nonsysnonymous/synonymous rate ratio. While our program can read in protein and standard discrete morphological data, this tutorial does not explicitly detail how to calculate likelihoods under those models; however, implementing GTR+I+G and a codon model illustrates enough of the complexity that you should be able to implement other models on your own.</p>

<div>
<table class="table table-striped" style="width:100%">
<tr class="header">
<td width="15%"><b>Step</b></td>
<td width="25%"><b>Title</b></td>
<td width="50%"><b>Description</b></td>
</tr>

		<tr class="part" id="11-1">
		<td>Step 11.1</td>
		<td><a href="/people/plewis/cpp/mac/steps/step-11/01-specifying-the-model.html">Specifying a model</a></td>
		<td><p>How the user will specify a partitioned model.</p>
</td>
		</tr>
	
		<tr class="part" id="11-2">
		<td>Step 11.2</td>
		<td><a href="/people/plewis/cpp/mac/steps/step-11/02-the-model-class.html">The Model class</a></td>
		<td><p>Create the Model class</p>
</td>
		</tr>
	
		<tr class="part" id="11-3">
		<td>Step 11.3</td>
		<td><a href="/people/plewis/cpp/mac/steps/step-11/03-the-qmatrix-class.html">The QMatrix class</a></td>
		<td><p>Create the QMatrix, QMatrixNucleotide, and QMatrixCodon classes</p>
</td>
		</tr>
	
		<tr class="part" id="11-4">
		<td>Step 11.4</td>
		<td><a href="/people/plewis/cpp/mac/steps/step-11/04-the-asrv-class.html">The ASRV class</a></td>
		<td><p>Create the ASRV class</p>
</td>
		</tr>
	
		<tr class="part" id="11-5">
		<td>Step 11.5</td>
		<td><a href="/people/plewis/cpp/mac/steps/step-11/05-adding-model-to-likelihood.html">Adding the Model to the Likelihood class</a></td>
		<td><p>Connect the Model class to the Likelihood class.</p>
</td>
		</tr>
	
		<tr class="part" id="11-6">
		<td>Step 11.6</td>
		<td><a href="/people/plewis/cpp/mac/steps/step-11/06-testing-model.html">Test the Model class</a></td>
		<td><p>Add program options to specify the model and test the Model class.</p>
</td>
		</tr>
	
</table>
</div>


<div class="titlebar">
	<h3 class="subsection"><a href="/people/plewis/cpp//mac//steps/step-10/00-calculating-the-likelihood.html">&lt;&nbsp;10.0</a> | 11.0 | <a href="/people/plewis/cpp//mac//steps/step-11/01-specifying-the-model.html">11.1&nbsp;&gt;</a></h3>
</div>


      <br>
<footer>
  <div class="container">
  <div class="row">
    <div class="col-sm-12" align="center">
      <a href="https://github.com/stromtutorial">GitHub</a> | <a href="/people/plewis/cpp/mac/acknowledgements/">Acknowledgements</a> | <a href="/people/plewis/cpp/mac/license/">License</a> | <a href="/people/plewis/cpp/mac/citation/">Citation</a>
    </div>
  </div>
  <br>
  </div>
</footer>

    </div>
    <script src="/people/plewis/cpp/assets/js/jquery.min.js"></script>
    <script src="/people/plewis/cpp/assets/js/highlight.js"></script>
    <script src="/people/plewis/cpp/assets/js/bootstrap.bundle.js"></script>
  </body>
</html>
